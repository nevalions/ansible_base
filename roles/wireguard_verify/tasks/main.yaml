---
- name: Import interface verification
  ansible.builtin.include_tasks: verify_interface.yaml

- name: Import keys verification
  ansible.builtin.include_tasks: verify_keys.yaml

- name: Import connectivity verification
  ansible.builtin.include_tasks: verify_connectivity.yaml

- name: Import firewall verification
  ansible.builtin.include_tasks: verify_firewall.yaml

- name: Generate verification report
  ansible.builtin.debug:
    msg:
      - "=== WireGuard Network Verification Report ==="
      - "Interface {{ vault_wg_interface }}: {{ 'UP' if wg_interface_status.rc == 0 else 'DOWN' }}"
      - "Server Public Key: {{ ((vault_wg_server_public_key if vault_wg_server_public_key is not none else 'N/A') | default('N/A'))[:20] }}...[truncated]"
      - "Peers configured: {{ vault_wg_peers | length }}"
      - "Connectivity: {{ 'Functional' if connectivity_tests_failed | int == 0 else 'Issues detected' }}"
      - "Firewall: {{ 'Configured' if ufw_status_check.rc == 0 else 'Issues detected' }}"
      - "============================================="
