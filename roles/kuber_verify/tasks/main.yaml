---
- name: Initialize verification status
  ansible.builtin.set_fact:
    cni_ready: false

- name: Import control plane verification
  ansible.builtin.include_tasks: verify_control_plane.yaml

- name: Import worker verification
  ansible.builtin.include_tasks: verify_workers.yaml

- name: Import networking verification
  ansible.builtin.include_tasks: verify_networking.yaml

- name: Generate verification report
  ansible.builtin.debug:
    msg:
      - "=== Kubernetes Cluster Verification Report ==="
      - "Control Plane: Ready"
      - "CNI ({{ cni_type | default('unknown') }}): {{ 'Operational' if cni_ready else 'Issues detected' }}"
      - "Worker Nodes: {{ worker_node_count | default(0) }} joined"
      - "Networking: {{ 'Functional' if ((pod_connectivity | default({})).get('rc', 1) == 0) else 'Issues detected' }}"
      - "DNS: {{ 'Functional' if ((dns_resolution | default({})).get('rc', 1) == 0) else 'Issues detected' }}"
      - "============================================"
