#!/bin/bash
# Git post-merge hook to automatically update hooks after pulling changes
# Ensures all team members have the latest version of hooks

set -e

# ANSI color codes
RED='\033[0;31m'
YELLOW='\033[1;33m'
GREEN='\033[0;32m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

echo -e "${BLUE}=== Auto-updating Git hooks ===${NC}\n"

# Get repository root directory
REPO_ROOT="$(git rev-parse --show-toplevel)"
SETUP_SCRIPT="$REPO_ROOT/scripts/setup_hooks.sh"

# Check if setup script exists
if [ ! -f "$SETUP_SCRIPT" ]; then
    echo -e "${YELLOW}⚠ Setup script not found, skipping hook update${NC}"
    exit 0
fi

# Run setup script silently
if bash "$SETUP_SCRIPT" > /dev/null 2>&1; then
    echo -e "${GREEN}✓ Git hooks updated successfully${NC}\n"
else
    echo -e "${RED}✗ Failed to update hooks (non-fatal)${NC}\n"
fi

exit 0
